"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9248],{3033:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var r=s(4700);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},3914:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Express/Request_Response","title":"Request_Response","description":"Topic 8 Typing  req,  res, and Handling JSON in Express","source":"@site/newdocs/Express/4. Request_Response.md","sourceDirName":"Express","slug":"/Express/Request_Response","permalink":"/vibe/newdocs/Express/Request_Response","draft":false,"unlisted":false,"editUrl":"https://github.com/your-org/\u2026/newdocs/Express/4. Request_Response.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"newSidebar","previous":{"title":"HTTP Methods & Status Codes","permalink":"/vibe/newdocs/Express/HTTP Methods & Status Codes"},"next":{"title":"Routing Controllers","permalink":"/vibe/newdocs/Express/Routing Controllers"}}');var t=s(7968),i=s(3033);const o={},d=void 0,l={},c=[{value:"1. Problem Statement: A Day at &quot;FreshMart&quot; Grocery Stores",id:"1-problem-statement-a-day-at-freshmart-grocery-stores",level:2},{value:"<strong>The Crisis at FreshMart</strong>",id:"the-crisis-at-freshmart",level:2},{value:"2. Learning Objectives",id:"2-learning-objectives",level:2},{value:"3. Concept Introduction with Analogy",id:"3-concept-introduction-with-analogy",level:2},{value:"<strong>Analogy: The Restaurant Kitchen</strong>",id:"analogy-the-restaurant-kitchen",level:2},{value:"5. Step-by-Step Data Flow",id:"5-step-by-step-data-flow",level:2},{value:"6. Interactive Challenge",id:"6-interactive-challenge",level:2},{value:"7. Common Pitfalls &amp; Best Practices",id:"7-common-pitfalls--best-practices",level:2},{value:"8. Quick Recap &amp; Key Takeaways",id:"8-quick-recap--key-takeaways",level:2},{value:"9. Optional: Programmer\u2019s Workflow Checklist",id:"9-optional-programmers-workflow-checklist",level:2}];function a(e){const n={br:"br",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Topic 8: Request/Response: Typing  ",(0,t.jsx)(n.code,{children:"req"}),",  ",(0,t.jsx)(n.code,{children:"res"}),", and Handling JSON in Express"]}),"\n",(0,t.jsx)(n.h2,{id:"1-problem-statement-a-day-at-freshmart-grocery-stores",children:'1. Problem Statement: A Day at "FreshMart" Grocery Stores'}),"\n",(0,t.jsx)(n.h2,{id:"the-crisis-at-freshmart",children:(0,t.jsx)(n.strong,{children:"The Crisis at FreshMart"})}),"\n",(0,t.jsx)(n.p,{children:"FreshMart, a bustling grocery chain, launched a digital loyalty program to reward customers. But chaos ensued:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Missing Data:"}),"  Customers tried to redeem points, but the app crashed if their profile was incomplete."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Invalid Requests:"}),'  A customer entered "1000 points" instead of "100," redeeming $1,000 by accident.']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Confusing Responses:"}),"  Staff couldn\u2019t tell if a request failed due to a server error or invalid input."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"The breaking point:"}),(0,t.jsx)(n.br,{}),"\n","A customer named Sarah tried to redeem points for a birthday cake. The app accepted her request but didn\u2019t check if she had enough points. The system deducted 500 points (her entire balance), but the cake order failed because the store was out of stock. Sarah left furious, and FreshMart\u2019s reputation tanked."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Your mission:"}),(0,t.jsx)(n.br,{}),"\n","Redesign FreshMart\u2019s loyalty API to:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Validate every request."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure responses are clear and structured."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Prevent invalid data from causing errors."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"2-learning-objectives",children:"2. Learning Objectives"}),"\n",(0,t.jsx)(n.p,{children:"By the end of this lesson, you\u2019ll be able to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Type request bodies, query params, and responses with TypeScript."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Validate JSON data using schemas and middleware."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Return consistent error messages and status codes."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Use advanced Express patterns for type safety."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Prevent bugs like Sarah\u2019s mishap through strict validation."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"3-concept-introduction-with-analogy",children:"3. Concept Introduction with Analogy"}),"\n",(0,t.jsx)(n.h2,{id:"analogy-the-restaurant-kitchen",children:(0,t.jsx)(n.strong,{children:"Analogy: The Restaurant Kitchen"})}),"\n",(0,t.jsx)(n.p,{children:"Imagine a restaurant kitchen:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Waiters (Requests):"}),"  Take orders from customers."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Chefs (API Logic):"}),"  Prepare meals based on orders."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Quality Control (Validation):"}),'  Checks orders for completeness (e.g., "No gluten, please").']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Server (Responses):"}),"  Delivers meals or explains why an order can\u2019t be fulfilled."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it maps to FreshMart\u2019s API:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:'If a waiter (request) doesn\u2019t specify "no gluten" (missing data), the kitchen (API) might serve a dish that makes the customer sick.'}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"If the chef (API) doesn\u2019t check stock (validation), they might promise a cake they can\u2019t deliver."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Quality control (TypeScript types) ensures every order (request) has the right details before the kitchen starts cooking."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"A. Typing Requests and Responses"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"1. Defining Strict Interfaces"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"}),"  Without types, requests like  ",(0,t.jsx)(n.code,{children:'{ points: "100" }'}),"  (string) might be processed as  ",(0,t.jsx)(n.code,{children:"100"}),"  (number), causing bugs.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Solution:"}),"  Use TypeScript interfaces to enforce data shapes."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// Loyalty program interfaces\ninterface RedeemRequest {\ncustomerId: string;\npoints: number;\n}\n\ninterface ApiResponse<T = any> {\nstatus: "success" | "error";\ndata?: T;\nerror?: string;\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["2. Typing Express  ",(0,t.jsx)(n.code,{children:"Request"}),"  and  ",(0,t.jsx)(n.code,{children:"Response"})]})}),"\n",(0,t.jsx)(n.p,{children:"Use generics to lock down body, query, and params:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'import { Request, Response } from "express";\n\nrouter.post(\n"/redeem",\n(req: Request<{}, {}, RedeemRequest>, // Body type\n res: Response<ApiResponse<{ remainingPoints: number }>>) => { // Response type\n  // ...logic...\n}\n);\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Why?"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"req.body"}),"  is now strictly typed. Passing  ",(0,t.jsx)(n.code,{children:'{ points: "100" }'}),"  will throw a TypeScript error."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The response shape is predefined, ensuring consistency."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"B. Validating Data with Zod"}),"\n",(0,t.jsx)(n.strong,{children:"1. Schema Validation"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem:"}),"  TypeScript types are stripped at runtime. Malicious clients can still send invalid data.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Solution:"}),"  Use Zod to validate requests at runtime."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'import { z } from "zod";\n\nconst RedeemSchema = z.object({\ncustomerId: z.string().uuid(),\npoints: z.number().int().positive(),\n});\n\nrouter.post("/redeem", (req, res) => {\nconst result = RedeemSchema.safeParse(req.body);\nif (!result.success) {\n  return res.status(400).json({\n    status: "error",\n    error: result.error.errors[0].message,\n  });\n}\n// Proceed with validated data (result.data)\n});\n\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"2. Centralized Validation Middleware"}),"\nAvoid repeating validation logic:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'import { RequestHandler } from "express";\n\nfunction validate<T extends z.ZodTypeAny>(schema: T): RequestHandler {\n  return (req, res, next) => {\n    const result = schema.safeParse(req.body);\n    if (!result.success) {\n      return res.status(400).json({ \n        status: "error", \n        error: result.error.errors[0].message \n      });\n    }\n    req.body = result.data; // Override req.body with parsed data\n    next();\n  };\n}\n\n// Usage\nrouter.post("/redeem", validate(RedeemSchema), (req, res) => {\n  // req.body is now validated and typed!\n});\n\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"C. Structured Error Handling"}),"\n",(0,t.jsx)(n.strong,{children:"1. Error Hierarchy"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'Define custom errors for clarity:\n\nclass ApiError extends Error {\n  constructor(\n    public statusCode: number,\n    message: string,\n    public details?: any\n  ) {\n    super(message);\n  }\n}\n\nclass InsufficientPointsError extends ApiError {\n  constructor() {\n    super(400, "Insufficient points");\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"2. Global Error Middleware"})}),"\n",(0,t.jsx)(n.p,{children:"Catch all errors and send consistent responses:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'   app.use((err: Error, req: Request, res: Response, next: NextFunction) => {\n  if (err instanceof ApiError) {\n    res.status(err.statusCode).json({\n      status: "error",\n      error: err.message,\n      details: err.details,\n    });\n  } else {\n    // Log unexpected errors but don\u2019t expose details\n    console.error(err);\n    res.status(500).json({ \n      status: "error", \n      error: "Internal server error" \n    });\n  }\n});\n\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage in routes:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'router.post("/redeem", validate(RedeemSchema), (req, res) => {\n  const member = findMember(req.body.customerId);\n  if (member.points < req.body.points) {\n    throw new InsufficientPointsError(); // Caught by global middleware\n  }\n  // ...redeem points...\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"D. Advanced: Custom Request Properties"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["1. Extending  ",(0,t.jsx)(n.code,{children:"Request"}),"  for Authentication"]})}),"\n",(0,t.jsxs)(n.p,{children:["Add user data to  ",(0,t.jsx)(n.code,{children:"req"}),"  after authentication:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'declare global {\n  namespace Express {\n    interface Request {\n      user?: {\n        id: string;\n        role: "customer" | "admin";\n      };\n    }\n  }\n}\n\n// Auth middleware\nrouter.use((req, res, next) => {\n  const token = req.headers.authorization;\n  if (token) {\n    req.user = decodeToken(token); // Assume this returns a user object\n  }\n  next();\n});\n\n// Usage in routes\nrouter.get("/profile", (req, res) => {\n  if (!req.user) {\n    throw new ApiError(401, "Unauthorized");\n  }\n  res.json({ status: "success", data: req.user });\n});\n\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"E. Real-World Example: Full Redeem Endpoint"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'router.post(\n  "/redeem",\n  validate(RedeemSchema),\n  async (req: Request<{}, {}, RedeemRequest>, res: Response) => {\n    const { customerId, points } = req.body;\n\n    // Check customer exists\n    const member = await db.loyaltyMembers.findOne({ customerId });\n    if (!member) {\n      throw new ApiError(404, "Customer not found");\n    }\n\n    // Check points\n    if (member.points < points) {\n      throw new InsufficientPointsError();\n    }\n\n    // Check item availability\n    const item = await db.inventory.findOne({ sku: "CAKE" });\n    if (!item || item.stock < 1) {\n      throw new ApiError(409, "Item out of stock");\n    }\n\n    // Deduct points and update inventory\n    await db.loyaltyMembers.updateOne(\n      { customerId },\n      { $inc: { points: -points } }\n    );\n    await db.inventory.updateOne({ sku: "CAKE" }, { $inc: { stock: -1 } });\n\n    // Success!\n    res.json({\n      status: "success",\n      data: { \n        customerId, \n        remainingPoints: member.points - points,\n        item: "CAKE" \n      },\n    });\n  }\n);\n\n'})}),"\n",(0,t.jsx)(n.h2,{id:"5-step-by-step-data-flow",children:"5. Step-by-Step Data Flow"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Received:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Client sends  ",(0,t.jsx)(n.code,{children:"POST /redeem"}),"  with  ",(0,t.jsx)(n.code,{children:'{ customerId: "123", points: 500 }'}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Validation Middleware:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Zod checks if  ",(0,t.jsx)(n.code,{children:"points"}),"  is a positive integer."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If invalid, returns  ",(0,t.jsx)(n.code,{children:"400 Bad Request"}),"  with error details."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Authentication Middleware:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Checks  ",(0,t.jsx)(n.code,{children:"Authorization"}),"  header and attaches  ",(0,t.jsx)(n.code,{children:"req.user"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Business Logic:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Checks customer existence, points, and inventory."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Throws specific errors for each failure case."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Global Error Handler:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Catches errors and sends structured responses."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Success Response:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Returns  ",(0,t.jsx)(n.code,{children:"200 OK"}),"  with remaining points and redeemed item."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"6-interactive-challenge",children:"6. Interactive Challenge"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Your Turn!"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add a  ",(0,t.jsx)(n.code,{children:"POST /transfer"}),"  endpoint allowing customers to transfer points to another account."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Validate:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Both  ",(0,t.jsx)(n.code,{children:"fromCustomerId"}),"  and  ",(0,t.jsx)(n.code,{children:"toCustomerId"}),"  must be valid UUIDs."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"points"}),"  must be a positive integer."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The sender must have enough points."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Return appropriate errors for each failure case."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"7-common-pitfalls--best-practices",children:"7. Common Pitfalls & Best Practices"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Pitfall"}),(0,t.jsx)(n.th,{children:"Best Practice"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Using any for request bodies"}),(0,t.jsx)(n.td,{children:"Always type with interfaces/Zod schemas"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Ignoring runtime validation"}),(0,t.jsx)(n.td,{children:"Use Zod even if TypeScript is enabled"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Generic error messages"}),(0,t.jsx)(n.td,{children:"Throw specific errors (e.g., InsufficientPointsError)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Mixing response formats"}),(0,t.jsx)(n.td,{children:"Standardize responses with ApiResponse"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"8-quick-recap--key-takeaways",children:"8. Quick Recap & Key Takeaways"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Type Everything:"}),"  From request bodies to custom  ",(0,t.jsx)(n.code,{children:"Request"}),"  properties."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Validate at Runtime:"}),"  TypeScript isn\u2019t enough-Zod catches malicious data."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Structured Errors:"}),"  Use custom errors and global middleware for consistency."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Centralized Logic:"}),"  Middleware for auth/validation reduces code duplication."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"9-optional-programmers-workflow-checklist",children:"9. Optional: Programmer\u2019s Workflow Checklist"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Define Zod schemas for all incoming data."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Use  ",(0,t.jsx)(n.code,{children:"ApiResponse"}),"  for all JSON responses."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Throw  ",(0,t.jsx)(n.code,{children:"ApiError"}),"  or subclasses for known failures."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Test edge cases: invalid UUIDs, negative points, etc."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Log unexpected errors but don\u2019t expose details."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);